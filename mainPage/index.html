<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <title>JResiduenrechner</title>
        <link rel="stylesheet" type="text/css" href="style.css"/>
        <link rel="shortcut icon" type="image/icon" href="icon.png">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<!--		<script language="javascript" type="text/javascript" src="main.js"></script>-->
        <script type="text/javascript">

        function relevantData(element) {
            if (element.type === "text")
                return element.value != "" ? element.value: "null";
            if (element.type === "checkbox")
                return element.checked;
            return "nul";
        }

    	function sendInputTroughPHPIntoDiv(phpFile, outputDiv, loadData) {
    	    //alert("called with " + phpFile + ", " + outputDiv + ", " + loadData);
    	    let formData = Array.from(document.getElementsByClassName("II"))
					.reduce(
						(data, element) => {
							// Add the current field to the object.
							data[element.id] = relevantData(element);
							return data;
						}, {}
					);
            formData["loadData"] = loadData;
        	jQuery.ajax({
				url: phpFile + ".php",
				data: formData,
				datatype: "json", type: "POST",
				success: function (data) {
					//alert(data);
                    sendHTMLIntoDiv(data, outputDiv);
				}
       		});
    	}

    	function sendHTMLIntoDiv(htmlCode, outputDiv) {
            document.getElementById("ausgabe" + outputDiv).innerHTML = htmlCode;
        }

        function funktionSubmit() {
            sendInputTroughPHPIntoDiv('Ausgabe', 1, false);
            showVariables();
            sendHTMLIntoDiv('', 3);
        }

        function showVariables() {
            sendInputTroughPHPIntoDiv('VariableList', 2, true);
        }

        function reloadSecondArea() {
            sendInputTroughPHPIntoDiv('Ausgabe', 3, true);
        }

        </script>

    </head>
    <body>
        <h1> Residuenrechner </h1>

        <div id = constDiv>
            <form>
                <label> f(
                <input class="II" type="text" id="workVariable" size="3">
                ) = <br></label>
                <input class="II" type="text" id="formel" size="80">
                <br>
                <label>
                <input type="checkbox" checked="checked" class="II" id="cIDP"> , als Dezimaltrenner</label>
            </form>
            <br>
            <button onclick = "funktionSubmit()"> Funktion parsen </button>
            <button onclick = "showVariables()"> Variablenliste aktualisieren </button>

        </div>

        <div id = ausgabe1></div>
        <div id = ausgabe2></div>
        <div id = ausgabe3></div>
<!--
        <footer>
            <p>&#x00A9; 2019 jgeigers.de</p>
            <p class="foot">
                Diese Website ist noch in Bearbeitung! Einige Funktionen k√∂nnen fehlerhaft sein.
            </p>
			<a href="impressum">Impressum</a>
        </footer>-->
    </body>
</html>